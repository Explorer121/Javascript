<html>

<head>

<title>Automated Table of Contents</title>

<script language="JavaScript" src="dom.js"></script>

<script language="JavaScript"><!--
var anchor, level = 0, headings = '  H1H2H3H4H5H6';

function retrieveToc(node) {
  var output = '';

  for (var i=0; i<node.childNodes.length; i++)
    output += retrieveToc(node.childNodes[i]);

  if (node.nodeType == 1) {

    var sublevel = headings.indexOf(node.nodeName) / 2;

    if (sublevel > 0) {
      if (sublevel > level)
        output += '<ul>\n';
      else
        output += '</li>\n';

      if (sublevel < level)
        output += '</ul>\n';

      level = sublevel;
      output += '<li>';
      anchor = null;
      var text = retrieveText(node);

      if (anchor != null)
        output += '<a href="#' + anchor + '">' + text + '</a>';
      else
        output += text;
    }
  }

  return output;
}

function retrieveText(node) {
  var output = '';

  for (var i=0; i<node.childNodes.length; i++)
    output += retrieveText(node.childNodes[i]);

  if (node.nodeType == 1 && node.nodeName == 'A')
    retrieveAnchor(node);

  if (node.nodeType == 3)
    output += node.nodeValue;

  return output;
}

function retrieveAnchor(node) {
  for (var i=0; i<node.attributes.length; i++) {
    if (node.attributes[i].nodeName == 'name') {
      anchor = node.attributes[i].nodeValue;
    }
  }
}

function start() {
  if (document.getElementById) {
    var output = retrieveToc(document.body);

    for (var i=level; i>0; i--)
      output += '</li>\n</ul>\n';

    if (output != '')
      output = '<h1>Table of Contents</h1>' + output;

    var toc = document.getElementById('toc');
    DOMElementSetInnerHTML(toc, output);
  }
}
//--></script>

<style><!--
p,a,ul,li,h1,h2,h3,h4,h5,h6 {font-family:Arial,Helvetica,serif;}
//--></style>

</head>

<body onLoad="start()">

<div id="toc"></div>

<h1><a name="1">Heading</a></h1>

<p>
Sed ut perspiciatis unde omnis iste natus error sit voluptatem
accusantium doloremque laudantium, totam rem aperiam, eaque
ipsa ab illo inventore veritatis et quasi architecto beatae
vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia
voluptas sit aspernatur aut odit aut fugit, sed quia
onsequuntur magni dolores eos qui ratione voluptatem sequi
nesciunt.
</p>

<h2><a name="1.1">Sub-Heading</a></h2>

<p>
Et harum quidem rerum facilis est et expedita distinctio.
</p>

<h2><a name="1.2">Sub-Heading</a></h2>

<p>
Neque porro quisquam est qui do lorem ipsum quia
dolor sit amet, consectetur, adipisci velit, sed quia
nonnumquam eiusmodi tempora incidunt ut labore et dolore magnam
aliquam quaerat voluptatem.
</p>

<h3><a name="1.2.1">Sub-sub-heading</a></h3>

<p>
Ut enim ad minima veniam, quia
nostrum exercitationem ullam corporis suscipit laboriosam, nisi
ut aliquid ex ea commodi consequatur? Quis autem vel eum iure
reprehenderit qui in ea voluptate velit esse quam nihil
molestiae consequatur, vel illum qui dolorem eum fugiat quo
voluptas nulla pariatur? At vero eos et accusamus et iusto odio
dignissimos ducimus qui blanditiis praesentium voluptatum
deleniti atque corrupti quos dolores et quas molestias
excepturi sint occaccati cupiditate non provident, similique
sunt in culpa qui officia deserunt mollitia animi, id est
laborum et dolorum fuga.
</p>

<h3><a name="1.2.2">Sub-sub-heading</a></h3>

<p>
Et harum quidem rerum facilis est et expedita distinctio.
</p>

<h2><a name="1.3">Sub-Heading</a></h2>

<p>
Nam libero tempore, cum soluta nobis est
eligendi optio cumque nihil impedit quo minus id quod maxime
placeat facere possimus, omnis dolor repellendus. Temporibus
autem quibusdam et aut officiis debitis aut rerum
necessitatibus saepe eveniet ut et voluptates repudiandae sint
et molestiae non recusandae. Itaque earum rerum hic tenetur a
sapiente delectus ut aut reiciendis voluptatibus maiores alias
consequatur aut perferendis doloribus asperiores repellat.
Sed ut perspiciatis unde omnis iste natus error sit voluptatem
accusantium doloremque laudantium, totam rem aperiam, eaque
ipsa ab illo inventore veritatis et quasi architecto beatae
vitae dicta sunt explicabo.
</p>

<h1><a name="2">Heading</a></h1>

<p>
Nemo enim ipsam voluptatem quia
voluptas sit aspernatur aut odit aut fugit, sed quia
onsequuntur magni dolores eos qui ratione voluptatem sequi
nesciunt. Neque porro quisquam est qui do lorem ipsum quia
dolor sit amet, consectetur, adipisci velit, sed quia
nonnumquam eiusmodi tempora incidunt ut labore et dolore magnam
aliquam quaerat voluptatem. Ut enim ad minima veniam, quia
nostrum exercitationem ullam corporis suscipit laboriosam, nisi
ut aliquid ex ea commodi consequatur? Quis autem vel eum iure
reprehenderit qui in ea voluptate velit esse quam nihil
molestiae consequatur, vel illum qui dolorem eum fugiat quo
voluptas nulla pariatur? At vero eos et accusamus et iusto odio
dignissimos ducimus qui blanditiis praesentium voluptatum
deleniti atque corrupti quos dolores et quas molestias
excepturi sint occaccati cupiditate non provident, similique
sunt in culpa qui officia deserunt mollitia animi, id est
laborum et dolorum fuga. Et harum quidem rerum facilis est et
expedita distinctio. Nam libero tempore, cum soluta nobis est
eligendi optio cumque nihil impedit quo minus id quod maxime
placeat facere possimus, omnis dolor repellendus. Temporibus
autem quibusdam et aut officiis debitis aut rerum
necessitatibus saepe eveniet ut et voluptates repudiandae sint
et molestiae non recusandae.
</p>

<h2><a name="2.2">Sub-Heading</a></h2>

<p>
Itaque earum rerum hic tenetur a
sapiente delectus ut aut reiciendis voluptatibus maiores alias
consequatur aut perferendis doloribus asperiores repellat.
</p>

<h3><a name="2.2.1">Sub-sub-heading</a></h3>

<p>
Sed ut perspiciatis unde omnis iste natus error sit voluptatem
accusantium doloremque laudantium, totam rem aperiam, eaque
ipsa ab illo inventore veritatis et quasi architecto beatae
vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia
voluptas sit aspernatur aut odit aut fugit, sed quia
onsequuntur magni dolores eos qui ratione voluptatem sequi
nesciunt. Neque porro quisquam est qui do lorem ipsum quia
dolor sit amet, consectetur, adipisci velit, sed quia
nonnumquam eiusmodi tempora incidunt ut labore et dolore magnam
aliquam quaerat voluptatem. Ut enim ad minima veniam, quia
nostrum exercitationem ullam corporis suscipit laboriosam, nisi
ut aliquid ex ea commodi consequatur? Quis autem vel eum iure
reprehenderit qui in ea voluptate velit esse quam nihil
molestiae consequatur, vel illum qui dolorem eum fugiat quo
voluptas nulla pariatur? At vero eos et accusamus et iusto odio
dignissimos ducimus qui blanditiis praesentium voluptatum
deleniti atque corrupti quos dolores et quas molestias
excepturi sint occaccati cupiditate non provident, similique
sunt in culpa qui officia deserunt mollitia animi, id est
laborum et dolorum fuga. Et harum quidem rerum facilis est et
expedita distinctio. Nam libero tempore, cum soluta nobis est
eligendi optio cumque nihil impedit quo minus id quod maxime
placeat facere possimus, omnis dolor repellendus. Temporibus
autem quibusdam et aut officiis debitis aut rerum
necessitatibus saepe eveniet ut et voluptates repudiandae sint
et molestiae non recusandae. Itaque earum rerum hic tenetur a
sapiente delectus ut aut reiciendis voluptatibus maiores alias
consequatur aut perferendis doloribus asperiores repellat.
</p>

<h2><a name="2.3">Sub-Heading</a></h2>

<p>
Sed ut perspiciatis unde omnis iste natus error sit voluptatem
accusantium doloremque laudantium, totam rem aperiam, eaque
ipsa ab illo inventore veritatis et quasi architecto beatae
vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia
voluptas sit aspernatur aut odit aut fugit, sed quia
onsequuntur magni dolores eos qui ratione voluptatem sequi
nesciunt.
</p>

<h3><a name="2.3.1">Sub-sub-heading</a></h3>

<p>
Neque porro quisquam est qui do lorem ipsum quia
dolor sit amet, consectetur, adipisci velit, sed quia
nonnumquam eiusmodi tempora incidunt ut labore et dolore magnam
aliquam quaerat voluptatem. Ut enim ad minima veniam, quia
nostrum exercitationem ullam corporis suscipit laboriosam, nisi
ut aliquid ex ea commodi consequatur? Quis autem vel eum iure
reprehenderit qui in ea voluptate velit esse quam nihil
molestiae consequatur, vel illum qui dolorem eum fugiat quo
voluptas nulla pariatur? At vero eos et accusamus et iusto odio
dignissimos ducimus qui blanditiis praesentium voluptatum
deleniti atque corrupti quos dolores et quas molestias
excepturi sint occaccati cupiditate non provident, similique
sunt in culpa qui officia deserunt mollitia animi, id est
laborum et dolorum fuga. Et harum quidem rerum facilis est et
expedita distinctio.
</p>

</body>

</html>